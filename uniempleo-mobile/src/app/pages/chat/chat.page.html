<ion-header>
  <ion-toolbar>
    <ion-title>Chat</ion-title>
    <ion-buttons slot="end" *ngIf="rol === 'empresa'">
      <ion-button [routerLink]="['/solicitudes']" fill="clear">
        <ion-label>Solicitudes</ion-label>
        <ion-badge color="danger" *ngIf="solicitudesCount > 0">
          {{ solicitudesCount }}
        </ion-badge>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="contacts-container">
    <div class="contacts-header">
      <h2>Contactos</h2>
      <p>Selecciona un contacto para comenzar a chatear</p>
    </div>

    <div *ngIf="cuentas.length > 0">
      <ion-list>
        <ion-item
          button
          (click)="abrirMensajes(u)"
          *ngFor="let u of cuentas"
          class="contact-item"
        >
          <ion-avatar slot="start">
            <img *ngIf="u.foto_url || u.logo_url" [src]="u.foto_url || u.logo_url" />
            <div *ngIf="!u.foto_url && !u.logo_url" class="avatar-iniciales">
              {{ (u.nombre_completo || u.razon_social)?.[0] | uppercase }}
            </div>
          </ion-avatar>
          <ion-label>
            <h2>{{ u.nombre_completo || u.razon_social }}</h2>
            <p>
              <ion-icon name="mail-outline" *ngIf="u.correo || u.correo_corporativo"></ion-icon>
              <span>{{ u.correo || u.correo_corporativo }}</span>
              <span *ngIf="(u.correo || u.correo_corporativo) && (u.ciudad || u.sector)"> • </span>
              <ion-icon name="location-outline" *ngIf="u.ciudad || u.sector"></ion-icon>
              <span>{{ u.ciudad || u.sector }}</span>
            </p>
          </ion-label>
        </ion-item>
      </ion-list>
    </div>

    <div class="empty-state-container" *ngIf="cuentas.length === 0">
      <app-empty-state
        icon="chatbubbles-outline"
        title="No hay contactos"
        message="Aún no tienes contactos para chatear. Las conversaciones aparecerán aquí cuando comiences a comunicarte con otros usuarios."
      ></app-empty-state>
    </div>
  </div>
</ion-content>
